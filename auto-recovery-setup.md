# 자동 복구 시스템 설정 가이드

## ⚠️ 자동 복구 시스템 비활성화됨

**이 자동복구 시스템은 현재 비활성화 상태입니다.**

## 🔄 자동 복구 시스템 개요 (비활성화됨)

Supabase가 일시중지된 후 다시 활성화되면 **자동으로 백업 파일에서 데이터를 복구**하는 시스템입니다. (현재 비활성화됨)

## ⚙️ 설정 방법

### Netlify 환경 변수 설정

Netlify 대시보드에서 다음 환경 변수를 추가하세요:

```
RECOVERY_API_KEY=auto-recovery-key-2024
NETLIFY_SITE_URL=https://your-site-name.netlify.app
```


## 🚀 자동 복구 방식

### 1. **사용자 요청 시 자동 복구**
- 사용자가 홈페이지에 접속하면 자동으로 복구 시도
- 백그라운드에서 조용히 실행 (사용자 경험에 영향 없음)

### 2. **관리자 수동 복구**
- 관리자 페이지에서 "자동 복구" 버튼 클릭
- 즉시 복구 실행 및 결과 확인

## 📋 복구 프로세스

### **자동 복구 시나리오:**

1. **일시중지 상태:**
   ```
   사용자 접속 → 백업 파일에서 데이터 표시 → 백그라운드 복구 시도
   ```

2. **복구 성공:**
   ```
   Supabase 활성화 감지 → 백업 파일 데이터 복구 → 정상 동작
   ```

3. **복구 완료:**
   ```
   다음 사용자 접속 시 → Supabase에서 정상 데이터 표시
   ```

## 🔧 관리자 기능

### **자동 복구 버튼:**
- **위치**: 관리자 페이지 → "자동 복구" 버튼
- **기능**: 수동으로 복구 실행
- **결과**: 복구된 데이터 개수 표시

### **복구 상태 확인:**
- Supabase 상태 체크
- 복구 가능 여부 확인
- 복구 결과 리포트

## 📊 복구 결과 예시

```json
{
  "success": true,
  "supabase_status": "active",
  "recovery_result": {
    "estimates_recovered": 5,
    "construction_recovered": 3,
    "total_recovered": 8,
    "total_errors": 0
  }
}
```

## ⚠️ 주의사항

### **중복 방지:**
- `upsert` 사용으로 중복 데이터 방지
- 기존 데이터는 덮어쓰지 않음

### **안전성:**
- 백업 파일은 삭제되지 않음
- 복구 실패 시에도 기존 데이터 보존

### **성능:**
- 백그라운드 실행으로 사용자 경험에 영향 없음
- 복구 중에도 서비스 정상 제공

## 🎯 완전 자동화 (비활성화됨)

~~이제 **완전히 자동화**되었습니다:~~

❌ **일시중지 중**: 백업 파일에서 데이터 표시 (비활성화됨)  
❌ **재시작 감지**: 자동으로 복구 시도 (비활성화됨)  
❌ **복구 완료**: 정상 서비스 제공 (비활성화됨)  
❌ **사용자 개입**: 불필요 (비활성화됨)  

~~**관리자가 아무것도 하지 않아도 자동으로 복구됩니다!** 🎉~~

**현재 자동복구 기능이 비활성화되어 있습니다.**
